# pentesting/sqlmap_scan.py

import subprocess

def run_sqlmap_scan(target):
    try:
        result = subprocess.run(
            ['sqlmap', '-u', target, '--batch', '--level=1'],
            stdout=subprocess.PIPE,
            stderr=subprocess.PIPE,
            text=True,
            timeout=180  # allow more time
        )
        return result.stdout if result.returncode == 0 else result.stderr
    except Exception as e:
        return f"[ERROR] SQLMap scan failed: {str(e)}"
