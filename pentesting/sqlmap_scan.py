# pentesting/sqlmap_scan.py
import subprocess

def run_sqlmap_scan(target, options=None):
    cmd = ['sqlmap', '-u', target]

    if options:
        cmd.extend(options)

    try:
        result = subprocess.check_output(cmd, stderr=subprocess.STDOUT, text=True)
        print(f"Running Nmap command: {' '.join(cmd)}")  # For debugging
        return result
    except subprocess.CalledProcessError as e:
        return f"SQLMap scan failed:\n{e.output}"
