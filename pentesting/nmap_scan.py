# pentesting/nmap_scan.py
import subprocess

def run_nmap_scan(target, options=None):
    try:
        cmd = ['nmap']

        # Add options if any were selected
        if options:
            cmd.extend(options)

        # Add the target last
        cmd.append(target)

        print(f"Running Nmap command: {' '.join(cmd)}")  # For debugging

        result = subprocess.check_output(cmd, text=True)
        return result

    except subprocess.CalledProcessError as e:
        return f"Nmap scan failed: {e}"
    except Exception as e:
        return f"Unexpected error: {e}"
