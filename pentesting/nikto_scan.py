# pentesting/nikto_scan.py
import subprocess

def run_nikto_scan(target, options=None):
    try:
        cmd = ["nikto", "-h", target]

        if options:
            cmd.extend(options)

        print(f"Running nikto command: {' '.join(cmd)}")  # For debugging
        result = subprocess.run(cmd, capture_output=True, text=True)
        return result.stdout + "\n" + result.stderr
    except Exception as e:
        return f"Error running Nikto: {e}"
